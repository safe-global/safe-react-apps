{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.browserSha512 = exports.browserSha256 = exports.browserHmacSha512Sign = exports.browserHmacSha256Sign = exports.browserAesDecrypt = exports.browserAesEncrypt = exports.browserImportKey = exports.browserExportKey = exports.browserRandomBytes = exports.getOps = exports.getAlgo = exports.getSubtleCrypto = exports.getBrowerCrypto = void 0;\n\nconst constants_1 = require(\"../constants\");\n\nconst fallback_1 = require(\"./fallback\");\n\nfunction getBrowerCrypto() {\n  return (global === null || global === void 0 ? void 0 : global.crypto) || (global === null || global === void 0 ? void 0 : global.msCrypto) || {};\n}\n\nexports.getBrowerCrypto = getBrowerCrypto;\n\nfunction getSubtleCrypto() {\n  const browserCrypto = getBrowerCrypto();\n  return browserCrypto.subtle || browserCrypto.webkitSubtle;\n}\n\nexports.getSubtleCrypto = getSubtleCrypto;\n\nfunction getAlgo(type) {\n  return type === constants_1.AES_BROWSER_ALGO ? {\n    length: constants_1.AES_LENGTH,\n    name: constants_1.AES_BROWSER_ALGO\n  } : {\n    hash: {\n      name: constants_1.HMAC_BROWSER_ALGO\n    },\n    name: constants_1.HMAC_BROWSER\n  };\n}\n\nexports.getAlgo = getAlgo;\n\nfunction getOps(type) {\n  return type === constants_1.AES_BROWSER_ALGO ? [constants_1.ENCRYPT_OP, constants_1.DECRYPT_OP] : [constants_1.SIGN_OP, constants_1.VERIFY_OP];\n}\n\nexports.getOps = getOps;\n\nfunction browserRandomBytes(length) {\n  const browserCrypto = getBrowerCrypto();\n\n  if (typeof browserCrypto.getRandomValues !== 'undefined') {\n    return browserCrypto.getRandomValues(new Uint8Array(length));\n  }\n\n  return fallback_1.fallbackRandomBytes(length);\n}\n\nexports.browserRandomBytes = browserRandomBytes;\n\nfunction browserExportKey(cryptoKey, type = constants_1.AES_BROWSER_ALGO) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const subtle = getSubtleCrypto();\n    return new Uint8Array(yield subtle.exportKey('raw', cryptoKey));\n  });\n}\n\nexports.browserExportKey = browserExportKey;\n\nfunction browserImportKey(buffer, type = constants_1.AES_BROWSER_ALGO) {\n  return __awaiter(this, void 0, void 0, function* () {\n    return getSubtleCrypto().importKey('raw', buffer, getAlgo(type), true, getOps(type));\n  });\n}\n\nexports.browserImportKey = browserImportKey;\n\nfunction browserAesEncrypt(iv, key, data) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const subtle = getSubtleCrypto();\n    const cryptoKey = yield browserImportKey(key, constants_1.AES_BROWSER_ALGO);\n    const result = yield subtle.encrypt({\n      iv,\n      name: constants_1.AES_BROWSER_ALGO\n    }, cryptoKey, data);\n    return new Uint8Array(result);\n  });\n}\n\nexports.browserAesEncrypt = browserAesEncrypt;\n\nfunction browserAesDecrypt(iv, key, data) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const subtle = getSubtleCrypto();\n    const cryptoKey = yield browserImportKey(key, constants_1.AES_BROWSER_ALGO);\n    const result = yield subtle.decrypt({\n      iv,\n      name: constants_1.AES_BROWSER_ALGO\n    }, cryptoKey, data);\n    return new Uint8Array(result);\n  });\n}\n\nexports.browserAesDecrypt = browserAesDecrypt;\n\nfunction browserHmacSha256Sign(key, data) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const subtle = getSubtleCrypto();\n    const cryptoKey = yield browserImportKey(key, constants_1.HMAC_BROWSER);\n    const signature = yield subtle.sign({\n      length: constants_1.HMAC_LENGTH,\n      name: constants_1.HMAC_BROWSER\n    }, cryptoKey, data);\n    return new Uint8Array(signature);\n  });\n}\n\nexports.browserHmacSha256Sign = browserHmacSha256Sign;\n\nfunction browserHmacSha512Sign(key, data) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const subtle = getSubtleCrypto();\n    const cryptoKey = yield browserImportKey(key, constants_1.HMAC_BROWSER);\n    const signature = yield subtle.sign({\n      length: constants_1.LENGTH_512,\n      name: constants_1.HMAC_BROWSER\n    }, cryptoKey, data);\n    return new Uint8Array(signature);\n  });\n}\n\nexports.browserHmacSha512Sign = browserHmacSha512Sign;\n\nfunction browserSha256(data) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const subtle = getSubtleCrypto();\n    const result = yield subtle.digest({\n      name: constants_1.SHA256_BROWSER_ALGO\n    }, data);\n    return new Uint8Array(result);\n  });\n}\n\nexports.browserSha256 = browserSha256;\n\nfunction browserSha512(data) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const subtle = getSubtleCrypto();\n    const result = yield subtle.digest({\n      name: constants_1.SHA512_BROWSER_ALGO\n    }, data);\n    return new Uint8Array(result);\n  });\n}\n\nexports.browserSha512 = browserSha512;","map":{"version":3,"sources":["../../../../src/helpers/env/browser.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.browserSha512 = exports.browserSha256 = exports.browserHmacSha512Sign = exports.browserHmacSha256Sign = exports.browserAesDecrypt = exports.browserAesEncrypt = exports.browserImportKey = exports.browserExportKey = exports.browserRandomBytes = exports.getOps = exports.getAlgo = exports.getSubtleCrypto = exports.getBrowerCrypto = void 0;\nconst constants_1 = require(\"../constants\");\nconst fallback_1 = require(\"./fallback\");\nfunction getBrowerCrypto() {\n    return (global === null || global === void 0 ? void 0 : global.crypto) || (global === null || global === void 0 ? void 0 : global.msCrypto) || {};\n}\nexports.getBrowerCrypto = getBrowerCrypto;\nfunction getSubtleCrypto() {\n    const browserCrypto = getBrowerCrypto();\n    return browserCrypto.subtle || browserCrypto.webkitSubtle;\n}\nexports.getSubtleCrypto = getSubtleCrypto;\nfunction getAlgo(type) {\n    return type === constants_1.AES_BROWSER_ALGO\n        ? { length: constants_1.AES_LENGTH, name: constants_1.AES_BROWSER_ALGO }\n        : {\n            hash: { name: constants_1.HMAC_BROWSER_ALGO },\n            name: constants_1.HMAC_BROWSER,\n        };\n}\nexports.getAlgo = getAlgo;\nfunction getOps(type) {\n    return type === constants_1.AES_BROWSER_ALGO\n        ? [constants_1.ENCRYPT_OP, constants_1.DECRYPT_OP]\n        : [constants_1.SIGN_OP, constants_1.VERIFY_OP];\n}\nexports.getOps = getOps;\nfunction browserRandomBytes(length) {\n    const browserCrypto = getBrowerCrypto();\n    if (typeof browserCrypto.getRandomValues !== 'undefined') {\n        return browserCrypto.getRandomValues(new Uint8Array(length));\n    }\n    return fallback_1.fallbackRandomBytes(length);\n}\nexports.browserRandomBytes = browserRandomBytes;\nfunction browserExportKey(cryptoKey, type = constants_1.AES_BROWSER_ALGO) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const subtle = getSubtleCrypto();\n        return new Uint8Array(yield subtle.exportKey('raw', cryptoKey));\n    });\n}\nexports.browserExportKey = browserExportKey;\nfunction browserImportKey(buffer, type = constants_1.AES_BROWSER_ALGO) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return getSubtleCrypto().importKey('raw', buffer, getAlgo(type), true, getOps(type));\n    });\n}\nexports.browserImportKey = browserImportKey;\nfunction browserAesEncrypt(iv, key, data) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const subtle = getSubtleCrypto();\n        const cryptoKey = yield browserImportKey(key, constants_1.AES_BROWSER_ALGO);\n        const result = yield subtle.encrypt({\n            iv,\n            name: constants_1.AES_BROWSER_ALGO,\n        }, cryptoKey, data);\n        return new Uint8Array(result);\n    });\n}\nexports.browserAesEncrypt = browserAesEncrypt;\nfunction browserAesDecrypt(iv, key, data) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const subtle = getSubtleCrypto();\n        const cryptoKey = yield browserImportKey(key, constants_1.AES_BROWSER_ALGO);\n        const result = yield subtle.decrypt({\n            iv,\n            name: constants_1.AES_BROWSER_ALGO,\n        }, cryptoKey, data);\n        return new Uint8Array(result);\n    });\n}\nexports.browserAesDecrypt = browserAesDecrypt;\nfunction browserHmacSha256Sign(key, data) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const subtle = getSubtleCrypto();\n        const cryptoKey = yield browserImportKey(key, constants_1.HMAC_BROWSER);\n        const signature = yield subtle.sign({\n            length: constants_1.HMAC_LENGTH,\n            name: constants_1.HMAC_BROWSER,\n        }, cryptoKey, data);\n        return new Uint8Array(signature);\n    });\n}\nexports.browserHmacSha256Sign = browserHmacSha256Sign;\nfunction browserHmacSha512Sign(key, data) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const subtle = getSubtleCrypto();\n        const cryptoKey = yield browserImportKey(key, constants_1.HMAC_BROWSER);\n        const signature = yield subtle.sign({\n            length: constants_1.LENGTH_512,\n            name: constants_1.HMAC_BROWSER,\n        }, cryptoKey, data);\n        return new Uint8Array(signature);\n    });\n}\nexports.browserHmacSha512Sign = browserHmacSha512Sign;\nfunction browserSha256(data) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const subtle = getSubtleCrypto();\n        const result = yield subtle.digest({\n            name: constants_1.SHA256_BROWSER_ALGO,\n        }, data);\n        return new Uint8Array(result);\n    });\n}\nexports.browserSha256 = browserSha256;\nfunction browserSha512(data) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const subtle = getSubtleCrypto();\n        const result = yield subtle.digest({\n            name: constants_1.SHA512_BROWSER_ALGO,\n        }, data);\n        return new Uint8Array(result);\n    });\n}\nexports.browserSha512 = browserSha512;\n//# sourceMappingURL=browser.js.map"]},"metadata":{},"sourceType":"script"}